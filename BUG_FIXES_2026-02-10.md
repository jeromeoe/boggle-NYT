# Bug Fixes - Leaderboard and Custom Board Issues

## Date: 2026-02-10

## Issues Fixed

### Issue 1: Random Board Scores Saved to Daily Leaderboard
**Problem:** After completing the Daily Challenge, when a player started a regular non-challenge game, their score from the random board was incorrectly being saved to the daily leaderboard. This happened because the `isDailyChallenge` flag was not being reset when starting a regular game.

**Solution:** 
- Modified `useGameLogic.ts` > `startGame()` function to reset the `isDailyChallenge` flag to `false`
- This ensures that regular games after a daily challenge are correctly identified as non-daily games
- Scores from regular games will no longer be submitted to the daily leaderboard

**Files Changed:**
- `src/hooks/useGameLogic.ts` - Added `setIsDailyChallenge(false)` in `startGame()`

### Issue 2: Custom Board Reset on Start Button Click
**Problem:** When a custom board was loaded using "Enter Custom Board Layout...", clicking the "Start New Game" button would immediately generate a new random board instead of using the loaded custom board. This made it impossible to play with custom boards.

**Solution:**
- Added new state `isCustomBoardLoaded` to track when a custom board has been loaded
- Created new function `startCustomGame()` that starts the game using the existing board without regenerating it
- Modified `loadCustomBoard()` to set the `isCustomBoardLoaded` flag to `true`
- Modified `startGame()` to reset the `isCustomBoardLoaded` flag when generating a new random board
- Updated `page.tsx` to conditionally use `startCustomGame` instead of `startGame` when a custom board is loaded

**Files Changed:**
- `src/hooks/useGameLogic.ts`:
  - Added `isCustomBoardLoaded` state
  - Added `startCustomGame()` function
  - Updated `loadCustomBoard()` to set the flag
  - Updated `startGame()` to reset the flag
  - Exported new state and function
- `src/app/page.tsx`:
  - Destructured `isCustomBoardLoaded` and `startCustomGame` from `useGameLogic()`
  - Updated `GameControls` component to use conditional logic: `onStart={isCustomBoardLoaded ? startCustomGame : startGame}`

## How It Works Now

### Daily Challenge Flow:
1. User clicks "Play Daily" → starts daily challenge with `isDailyChallenge = true`
2. User completes daily challenge → score is submitted to daily leaderboard
3. User clicks "Start New Game" → `isDailyChallenge` is reset to `false`
4. User completes regular game → score is NOT submitted to leaderboard ✅

### Custom Board Flow:
1. User clicks "Enter Custom Board Layout..." → enters 16 letters
2. Custom board is loaded, `isCustomBoardLoaded = true`, game is inactive
3. User sees "Custom board loaded. Press START to play."
4. User clicks "Start New Game" → `startCustomGame()` is called instead of `startGame()`
5. Game starts with the custom board intact ✅
6. When user clicks "Start New Game" again → `startGame()` is called, generating a random board and resetting the flag

## Testing Recommendations

### Test Case 1: Daily Challenge to Regular Game
1. Start and complete a daily challenge (logged in)
2. Verify score appears in leaderboard
3. Start a regular game (not daily challenge)
4. Complete the regular game
5. Check leaderboard - the regular game score should NOT appear

### Test Case 2: Custom Board Gameplay
1. Click "Enter Custom Board Layout..."
2. Enter 16 letters (e.g., "ABCDEFGHIJKLMNOP")
3. Verify custom board is displayed
4. Click "Start New Game"
5. Verify the custom board remains the same and timer starts
6. Play the game normally
7. After completing, click "Start New Game" again
8. Verify a new random board is generated
